
not python 3

### TODO

* write function for parsing and uploading mail
* write mail_view script for viewing inbox and searchresults easily
* write full text search indexing (in upload and search scripts)
* write module to load mails from Maildirs or mboxes
* Support comments and quoted strings in parseaddr.py
* Convert quoted-printable in subject and email displayname to utf8
* Check encoding on downloading and saving emails

### For use (not implemented ...yet)

* forward script
  Forward mails from postfix to upload script, to be put into ~/.forward

* ... more to come

### Python Modules

* config
  Configurations for logs, the CouchDB connection and other things.

* mail_upload
  Parse and upload a given mail. (Extract metadata, maybe get keywords)

* mail_search
  Search for mail hashes by metadata (maybe even keywords)
  Python function returns docs. Script prints list of hashes to stdout.

* mail_download
  Download mails with given hashes read from stdin into
  ** mbox or
  ** Maildir or
  ** execute a command for every mail with the mail given as stdin or
  ** write them simply to stdout (with no separation, only useful for one email)
  Every beginning of a line from stdin starting with hex chars is taken as a
  doc id and is downloaded. Add comments / more data separated with a whitespace
  after the hash, or start lines with whitespace or non hey char to ignore them.

### Document format

doc_id: sha256 hash of whole mail as in 'data' field
upload_date: date UTC, when the mail was uploaded in YYYY-MM-DD hh:mm:ss
            `date "+%Y-%M-%d %H:%m:%S"` i.e. 2013-12-08 11:12:42
flag: signed, encrypted
labels: list of unique label names, all lowercase

date: date UTC given in mail, in YYYY-MM-DD hh:mm:ss
from: array of email addresses of senders, all lowercase
to: array of email addresses of receivers, all lowercase
subject: string containing subject

original message as standalone attachment in named 'mail'
  with content-type: text/plain

### Database Views

  from

Emits one entry for every sender in From: field of a mail.
So you can search with
.../_design/post/_view/from?startkey=%22someone%22&endkey=%22xaver%22
Key: one address spec
Value: doc

  to

Emits one entry for every recipient in To: field of a mail.
Key: one address spec
Value: doc

  labels

Emits one entry for every label listed in doc.labels .
Key: one label string
Value: doc

  labels_list

A unique list of all labels used in all doc.labels .
Functions: Map & Reduce
Key: Null
Value: List of all labels

  inbox

All mails labeled "unread".
Functions: Map
Key: date
Value: flags

